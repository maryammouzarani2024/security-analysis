#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h>
#include <string.h>


#define ERROR(x) do { perror(x); exit(-1); } while (0);
int bad(char* data){
int a,b;
a=20;
if (a>10){
   b=a-10;

}
//if (data[0] =='l'){
 //	printf("OK");}
printf("%s", data);
 printf("%d",b);
   return 1;

}

void *strcat_(char *dst, const char * src){
	int i=0,j=0;
	while(dst[i]){
	i++;
	}
	while (src[j]){
	dst[i]=src[j];
	i++;
	j++;
	}
	return dst;
}	
void *memcpy_(char *dest, const char *src, size_t n) {
    while (n-- > 0) {
        dest[n] = src[n];
    }
    return dest;
}

int strcmp_(const char *s1, const char *s2) {
    int i = 0;
    
    //printf("**>\n");
    while (s1[i] && s2[i]) {
        if (s1[i] > s2[i]) {
            return 1;
        }
        else if (s1[i] < s2[i]) {
            return -1;
        }
        i++;
    }
    //printf("**<\n");
    
    return 0;
}

void shift(char *buffer, char *buffer2) {
    unsigned int i;
    
    for (i = 0; i < 4; i++) {
        buffer[i] = buffer2[(i + 1) % 4];
    }
}

int main(int argc, char *argv[]) {
	if (argc<2)
		return -1;

	int  fd1 = open(argv[1], O_RDONLY );

	char input[4];
	read(fd1, input, 10);
    
   // memcpy(buffer2, buffer, sizeof(buffer2));
    
    /*if (buffer[1] == 'a') {
        printf("ok\n");
    }*/
    
  //  shift(buffer, buffer2);
/*	if (input[1]== 'a'){
	printf("ok\n");	
}*/
	unsigned char data=input[0];
	int a;
	char* data2;
//data2=input;
strcpy(data2,"/usr/bin/cat");
//memcpy_(data2,"",1);
data2=strcat_(data2,input);
//printf("the result %s \n",data2);
	//if (input == &input[0])
	//	printf("equal %08x, %08x\n",input, &input[0]);
/*if(data2[4]=='Q'){

        printf("ok\n");
}
if(data2[5]=='Q'){

        printf("ok\n");
}
if(data2[6]=='Q'){

        printf("ok\n");
}
*/


system(data2);
//if (*input=="adf")	
//{        printf("ok\n");
//}
    /*if (strcmp(buffer, "bad!") == 0) {
        printf("ok\n");  be934380
    }*/

    return 0;
}



/* TEMPLATE GENERATED TESTCASE FILE
Filename: CWE190_Integer_Overflow__char_fscanf_add_31.c
Label Definition File: CWE190_Integer_Overflow.label.xml
Template File: sources-sinks-31.tmpl.c
*/
/*
 * @description
 * CWE: 190 Integer Overflow
 * BadSource: fscanf Read data from the console using fscanf()
 * GoodSource: Set data to a small, non-zero number (two)
 * Sinks: add
 *    GoodSink: Ensure there will not be an overflow before adding 1 to data
 *    BadSink : Add 1 to data, which can cause an overflow
 * Flow Variant: 31 Data flow using a copy of data within the same function
 *
 * */

/* goodG2B() uses the GoodSource with the BadSink */

